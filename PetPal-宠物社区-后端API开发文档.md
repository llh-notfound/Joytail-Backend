# PetPal å® ç‰©ç¤¾åŒº - åç«¯APIå¼€å‘æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬æ–‡æ¡£ä¸ºPetPalå® ç‰©ç¤¾åŒºæ¨¡å—çš„åç«¯APIå¼€å‘æŒ‡å—ã€‚å‰ç«¯å·²å®Œæˆå¼€å‘å¹¶å…·å¤‡å®Œæ•´çš„ç¤¾åŒºåŠŸèƒ½ï¼Œç±»ä¼¼å°çº¢ä¹¦/è´´å§çš„å® ç‰©ä¸»é¢˜ç¤¾åŒºå¹³å°ã€‚åç«¯éœ€è¦å®ç°12ä¸ªæ ¸å¿ƒAPIæ¥å£æ¥æ”¯æŒå‰ç«¯åŠŸèƒ½ã€‚

### ğŸ¯ é¡¹ç›®ç‰¹è‰²
- **ä¸“ä¸šå® ç‰©ç¤¾åŒº**: ä¸“æ³¨å® ç‰©ä¸»é¢˜å†…å®¹åˆ†äº«
- **ç°ä»£åŒ–UIè®¾è®¡**: ç€‘å¸ƒæµå¸ƒå±€ + ç²¾ç¾å¡ç‰‡è®¾è®¡
- **å®Œæ•´äº¤äº’åŠŸèƒ½**: å‘å¸ƒã€ç‚¹èµã€è¯„è®ºã€æ”¶è—ç­‰ç¤¾äº¤åŠŸèƒ½
- **ç”¨æˆ·ä½“éªŒä¼˜ç§€**: æ”¯æŒä¸‹æ‹‰åˆ·æ–°ã€ä¸Šæ‹‰åŠ è½½ã€å›¾ç‰‡é¢„è§ˆç­‰
- **APIè®¾è®¡åˆç†**: RESTfulé£æ ¼ï¼Œæ”¯æŒåˆ†é¡µã€è®¤è¯ç­‰

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Vue3 + uni-app (æ”¯æŒH5/å°ç¨‹åº/APP)
- **å¸ƒå±€**: ç€‘å¸ƒæµåŒåˆ—å¸ƒå±€
- **çŠ¶æ€ç®¡ç†**: Vue3 Composition API
- **ç½‘ç»œè¯·æ±‚**: uni.request + axioså°è£…
- **å›¾ç‰‡å¤„ç†**: uni-appåŸç”Ÿå›¾ç‰‡ç»„ä»¶

### åç«¯æŠ€æœ¯è¦æ±‚
- **APIé£æ ¼**: RESTful API
- **è®¤è¯æ–¹å¼**: JWT Token
- **æ•°æ®æ ¼å¼**: JSON
- **åˆ†é¡µ**: æ”¯æŒpage/pageSizeå‚æ•°
- **å›¾ç‰‡å­˜å‚¨**: å»ºè®®ä½¿ç”¨OSS/CDN
- **ç¼“å­˜**: å»ºè®®Redisç¼“å­˜çƒ­é—¨å†…å®¹

---

## ğŸ“Š æ•°æ®åº“è®¾è®¡å»ºè®®

### 1. ç¤¾åŒºåŠ¨æ€è¡¨ (community_posts)
```sql
CREATE TABLE community_posts (
  id VARCHAR(32) PRIMARY KEY COMMENT 'åŠ¨æ€ID',
  user_id VARCHAR(32) NOT NULL COMMENT 'å‘å¸ƒè€…ç”¨æˆ·ID',
  content TEXT COMMENT 'åŠ¨æ€å†…å®¹',
  images JSON COMMENT 'å›¾ç‰‡URLæ•°ç»„ï¼Œæœ€å¤š9å¼ ',
  tags JSON COMMENT 'è¯é¢˜æ ‡ç­¾æ•°ç»„',
  likes_count INT DEFAULT 0 COMMENT 'ç‚¹èµæ•°é‡',
  comments_count INT DEFAULT 0 COMMENT 'è¯„è®ºæ•°é‡',
  collects_count INT DEFAULT 0 COMMENT 'æ”¶è—æ•°é‡',
  status TINYINT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-æ­£å¸¸ï¼Œ0-åˆ é™¤',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'å‘å¸ƒæ—¶é—´',
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  
  INDEX idx_user_id (user_id),
  INDEX idx_created_at (created_at),
  INDEX idx_status (status)
) COMMENT 'ç¤¾åŒºåŠ¨æ€è¡¨';
```

### 2. åŠ¨æ€è¯„è®ºè¡¨ (community_comments)
```sql
CREATE TABLE community_comments (
  id VARCHAR(32) PRIMARY KEY COMMENT 'è¯„è®ºID',
  post_id VARCHAR(32) NOT NULL COMMENT 'åŠ¨æ€ID',
  user_id VARCHAR(32) NOT NULL COMMENT 'è¯„è®ºè€…ç”¨æˆ·ID',
  content TEXT NOT NULL COMMENT 'è¯„è®ºå†…å®¹',
  reply_to_id VARCHAR(32) COMMENT 'å›å¤çš„è¯„è®ºIDï¼ˆé¢„ç•™å­—æ®µï¼‰',
  status TINYINT DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š1-æ­£å¸¸ï¼Œ0-åˆ é™¤',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'è¯„è®ºæ—¶é—´',
  
  INDEX idx_post_id (post_id),
  INDEX idx_user_id (user_id),
  INDEX idx_created_at (created_at)
) COMMENT 'åŠ¨æ€è¯„è®ºè¡¨';
```

### 3. åŠ¨æ€ç‚¹èµè¡¨ (community_likes)
```sql
CREATE TABLE community_likes (
  id VARCHAR(32) PRIMARY KEY COMMENT 'ç‚¹èµID',
  post_id VARCHAR(32) NOT NULL COMMENT 'åŠ¨æ€ID',
  user_id VARCHAR(32) NOT NULL COMMENT 'ç‚¹èµç”¨æˆ·ID',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'ç‚¹èµæ—¶é—´',
  
  UNIQUE KEY uk_post_user (post_id, user_id),
  INDEX idx_user_id (user_id)
) COMMENT 'åŠ¨æ€ç‚¹èµè¡¨';
```

### 4. åŠ¨æ€æ”¶è—è¡¨ (community_collects)
```sql
CREATE TABLE community_collects (
  id VARCHAR(32) PRIMARY KEY COMMENT 'æ”¶è—ID',
  post_id VARCHAR(32) NOT NULL COMMENT 'åŠ¨æ€ID',
  user_id VARCHAR(32) NOT NULL COMMENT 'æ”¶è—ç”¨æˆ·ID',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'æ”¶è—æ—¶é—´',
  
  UNIQUE KEY uk_post_user (post_id, user_id),
  INDEX idx_user_id (user_id)
) COMMENT 'åŠ¨æ€æ”¶è—è¡¨';
```

---

## ğŸ”Œ APIæ¥å£è¯¦ç»†è®¾è®¡

### 1. è·å–ç¤¾åŒºåŠ¨æ€åˆ—è¡¨

**æ¥å£æè¿°**: è·å–ç¤¾åŒºåŠ¨æ€åˆ—è¡¨ï¼Œæ”¯æŒæ¨èå’Œæœ€æ–°ä¸¤ç§æ¨¡å¼

- **URL**: `GET /api/community/posts`
- **è®¤è¯**: å¯é€‰ï¼ˆç™»å½•ç”¨æˆ·å¯çœ‹åˆ°ä¸ªäººåŒ–çš„ç‚¹èµ/æ”¶è—çŠ¶æ€ï¼‰
- **è¯·æ±‚å‚æ•°**:
```json
{
  "type": "string",      // ç±»å‹: "recommend"(æ¨è) | "latest"(æœ€æ–°)ï¼Œé»˜è®¤recommend
  "page": "number",      // é¡µç ï¼Œé»˜è®¤1
  "pageSize": "number"   // æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10ï¼Œæœ€å¤§20
}
```

- **æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": "post_123456",
        "userId": "user_789",
        "username": "æŸ´çŠ¬éº»éº»",
        "avatar": "https://cdn.example.com/avatar.jpg",
        "content": "ä»Šå¤©å¸¦æˆ‘å®¶æŸ´æŸ´å»å…¬å›­ç©...",
        "images": [
          "https://cdn.example.com/img1.jpg",
          "https://cdn.example.com/img2.jpg"
        ],
        "publishTime": "2024-01-15T10:30:00Z",
        "likes": 328,
        "comments": 56,
        "collects": 23,
        "isLiked": false,      // å½“å‰ç”¨æˆ·æ˜¯å¦å·²ç‚¹èµ
        "isCollected": false,  // å½“å‰ç”¨æˆ·æ˜¯å¦å·²æ”¶è—
        "tags": ["æŸ´çŠ¬æ—¥å¸¸", "é›ç‹—æ—¥è®°"]
      }
    ],
    "total": 1250,
    "hasMore": true
  }
}
```

- **ä¸šåŠ¡é€»è¾‘**:
  - `recommend`: æŒ‰çƒ­åº¦æ’åºï¼ˆç‚¹èµæ•°+è¯„è®ºæ•°+æ”¶è—æ•°æƒé‡ç®—æ³•ï¼‰
  - `latest`: æŒ‰å‘å¸ƒæ—¶é—´å€’åº
  - éœ€è¦å…³è”ç”¨æˆ·è¡¨è·å–ç”¨æˆ·ä¿¡æ¯
  - å¦‚æœç”¨æˆ·å·²ç™»å½•ï¼Œéœ€è¦æŸ¥è¯¢ä¸ªäººç‚¹èµ/æ”¶è—çŠ¶æ€

---

### 2. å‘å¸ƒç¤¾åŒºåŠ¨æ€

**æ¥å£æè¿°**: ç”¨æˆ·å‘å¸ƒæ–°çš„ç¤¾åŒºåŠ¨æ€

- **URL**: `POST /api/community/posts`
- **è®¤è¯**: å¿…éœ€
- **è¯·æ±‚å‚æ•°**:
```json
{
  "content": "åˆ†äº«æˆ‘å®¶å® ç‰©çš„æ—¥å¸¸...",
  "images": [
    "https://cdn.example.com/upload/img1.jpg",
    "https://cdn.example.com/upload/img2.jpg"
  ],
  "tags": ["èŒå® æ—¥å¸¸", "æ–°æ‰‹å…»å® "]  // å¯é€‰ï¼Œè¯é¢˜æ ‡ç­¾
}
```

- **æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "å‘å¸ƒæˆåŠŸ",
  "data": {
    "postId": "post_123456"
  }
}
```

- **ä¸šåŠ¡é€»è¾‘**:
  - å†…å®¹å’Œå›¾ç‰‡è‡³å°‘æœ‰ä¸€ä¸ªä¸ä¸ºç©º
  - å›¾ç‰‡æ•°é‡é™åˆ¶ï¼šæœ€å¤š9å¼ 
  - å†…å®¹é•¿åº¦é™åˆ¶ï¼šæœ€å¤š500å­—ç¬¦
  - è‡ªåŠ¨æå–æˆ–éªŒè¯æ ‡ç­¾æ ¼å¼
  - éœ€è¦å†…å®¹å®¡æ ¸æœºåˆ¶ï¼ˆå…³é”®è¯è¿‡æ»¤ï¼‰

---

### 3. è·å–åŠ¨æ€è¯¦æƒ…

**æ¥å£æè¿°**: è·å–æŒ‡å®šåŠ¨æ€çš„è¯¦ç»†ä¿¡æ¯

- **URL**: `GET /api/community/posts/{postId}`
- **è®¤è¯**: å¯é€‰
- **è¯·æ±‚å‚æ•°**: è·¯å¾„å‚æ•° `postId`

- **æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": "post_123456",
    "userId": "user_789",
    "username": "æŸ´çŠ¬éº»éº»",
    "avatar": "https://cdn.example.com/avatar.jpg",
    "content": "ä»Šå¤©å¸¦æˆ‘å®¶æŸ´æŸ´å»å…¬å›­ç©...",
    "images": ["https://cdn.example.com/img1.jpg"],
    "publishTime": "2024-01-15T10:30:00Z",
    "likes": 328,
    "comments": 56,
    "collects": 23,
    "isLiked": false,
    "isCollected": false,
    "tags": ["æŸ´çŠ¬æ—¥å¸¸", "é›ç‹—æ—¥è®°"]
  }
}
```

---

### 4. ç‚¹èµ/å–æ¶ˆç‚¹èµåŠ¨æ€

**æ¥å£æè¿°**: åˆ‡æ¢åŠ¨æ€çš„ç‚¹èµçŠ¶æ€

- **URL**: `POST /api/community/posts/{postId}/like`
- **è®¤è¯**: å¿…éœ€
- **è¯·æ±‚å‚æ•°**: è·¯å¾„å‚æ•° `postId`

- **æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "isLiked": true,      // æ“ä½œåçš„ç‚¹èµçŠ¶æ€
    "likesCount": 329     // æ“ä½œåçš„ç‚¹èµæ€»æ•°
  }
}
```

- **ä¸šåŠ¡é€»è¾‘**:
  - å¦‚æœå·²ç‚¹èµåˆ™å–æ¶ˆï¼Œæœªç‚¹èµåˆ™æ·»åŠ 
  - æ›´æ–°åŠ¨æ€è¡¨çš„ç‚¹èµè®¡æ•°
  - å¯ä»¥è€ƒè™‘é˜²åˆ·æœºåˆ¶ï¼ˆé™åˆ¶é¢‘ç‡ï¼‰

---

### 5. æ”¶è—/å–æ¶ˆæ”¶è—åŠ¨æ€

**æ¥å£æè¿°**: åˆ‡æ¢åŠ¨æ€çš„æ”¶è—çŠ¶æ€

- **URL**: `POST /api/community/posts/{postId}/collect`
- **è®¤è¯**: å¿…éœ€
- **è¯·æ±‚å‚æ•°**: è·¯å¾„å‚æ•° `postId`

- **æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "isCollected": true,   // æ“ä½œåçš„æ”¶è—çŠ¶æ€
    "collectsCount": 24    // æ“ä½œåçš„æ”¶è—æ€»æ•°
  }
}
```

---

### 6. è·å–åŠ¨æ€è¯„è®ºåˆ—è¡¨

**æ¥å£æè¿°**: è·å–æŒ‡å®šåŠ¨æ€çš„è¯„è®ºåˆ—è¡¨

- **URL**: `GET /api/community/posts/{postId}/comments`
- **è®¤è¯**: å¯é€‰
- **è¯·æ±‚å‚æ•°**:
```json
{
  "page": 1,         // é¡µç ï¼Œé»˜è®¤1
  "pageSize": 20     // æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20
}
```

- **æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": "comment_123",
        "userId": "user_456",
        "username": "å…»çŒ«ä¸“å®¶",
        "avatar": "https://cdn.example.com/avatar2.jpg",
        "content": "çœ‹èµ·æ¥ç©å¾—å¾ˆå¼€å¿ƒå‘¢ï¼",
        "publishTime": "2024-01-15T11:30:00Z"
      }
    ],
    "total": 56,
    "hasMore": true
  }
}
```

---

### 7. å‘è¡¨åŠ¨æ€è¯„è®º

**æ¥å£æè¿°**: å¯¹æŒ‡å®šåŠ¨æ€å‘è¡¨è¯„è®º

- **URL**: `POST /api/community/posts/{postId}/comments`
- **è®¤è¯**: å¿…éœ€
- **è¯·æ±‚å‚æ•°**:
```json
{
  "content": "çœ‹èµ·æ¥ç©å¾—å¾ˆå¼€å¿ƒå‘¢ï¼"
}
```

- **æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "è¯„è®ºæˆåŠŸ",
  "data": {
    "commentId": "comment_123456"
  }
}
```

- **ä¸šåŠ¡é€»è¾‘**:
  - è¯„è®ºå†…å®¹ä¸èƒ½ä¸ºç©º
  - è¯„è®ºé•¿åº¦é™åˆ¶ï¼šæœ€å¤š200å­—ç¬¦
  - æ›´æ–°åŠ¨æ€è¡¨çš„è¯„è®ºè®¡æ•°
  - å†…å®¹å®¡æ ¸æœºåˆ¶

---

### 8. åˆ é™¤åŠ¨æ€è¯„è®º

**æ¥å£æè¿°**: åˆ é™¤æŒ‡å®šè¯„è®ºï¼ˆä»…è¯„è®ºä½œè€…æˆ–åŠ¨æ€ä½œè€…å¯åˆ é™¤ï¼‰

- **URL**: `DELETE /api/community/comments/{commentId}`
- **è®¤è¯**: å¿…éœ€
- **è¯·æ±‚å‚æ•°**: è·¯å¾„å‚æ•° `commentId`

- **æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "åˆ é™¤æˆåŠŸ"
}
```

- **ä¸šåŠ¡é€»è¾‘**:
  - éªŒè¯åˆ é™¤æƒé™ï¼ˆè¯„è®ºä½œè€…æˆ–åŠ¨æ€ä½œè€…ï¼‰
  - è½¯åˆ é™¤ï¼ˆä¿®æ”¹statuså­—æ®µï¼‰
  - æ›´æ–°åŠ¨æ€è¡¨çš„è¯„è®ºè®¡æ•°

---

### 9. è·å–æˆ‘çš„ç¤¾åŒºå†…å®¹

**æ¥å£æè¿°**: è·å–å½“å‰ç”¨æˆ·çš„ç¤¾åŒºç›¸å…³å†…å®¹

- **URL**: `GET /api/community/my`
- **è®¤è¯**: å¿…éœ€
- **è¯·æ±‚å‚æ•°**:
```json
{
  "type": "posts",      // ç±»å‹: "posts"(æˆ‘çš„å‘å¸ƒ) | "likes"(æˆ‘çš„ç‚¹èµ) | "collects"(æˆ‘çš„æ”¶è—) | "comments"(æˆ‘çš„è¯„è®º)
  "page": 1,
  "pageSize": 10
}
```

- **æˆåŠŸå“åº”**:

å¯¹äº `type="posts"` (æˆ‘çš„å‘å¸ƒ):
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": "post_123456",
        "content": "ä»Šå¤©å¸¦æˆ‘å®¶æŸ´æŸ´å»å…¬å›­ç©...",
        "images": ["https://cdn.example.com/img1.jpg"],
        "publishTime": "2024-01-15T10:30:00Z",
        "likes": 328,
        "comments": 56,
        "collects": 23
      }
    ],
    "total": 45,
    "hasMore": true
  }
}
```

å¯¹äº `type="likes|collects|comments"` (æˆ‘çš„äº’åŠ¨):
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": "record_123",      // äº’åŠ¨è®°å½•ID
        "postId": "post_456",    // åŸåŠ¨æ€ID
        "title": "ä»Šå¤©å¸¦æˆ‘å®¶æŸ´æŸ´...",     // åŠ¨æ€æ ‡é¢˜(æˆªå–)
        "summary": "ç¬¬ä¸€æ¬¡è§åˆ°è¿™ä¹ˆå¤š...", // åŠ¨æ€æ‘˜è¦
        "coverImage": "https://cdn.example.com/img1.jpg",
        "interactTime": "2024-01-15T12:00:00Z",
        "comment": "çœ‹èµ·æ¥å¾ˆå¼€å¿ƒ"  // ä»…commentsç±»å‹æœ‰æ­¤å­—æ®µ
      }
    ],
    "total": 128,
    "hasMore": true
  }
}
```

---

### 10. åˆ é™¤æˆ‘çš„åŠ¨æ€

**æ¥å£æè¿°**: åˆ é™¤ç”¨æˆ·è‡ªå·±å‘å¸ƒçš„åŠ¨æ€

- **URL**: `DELETE /api/community/posts/{postId}`
- **è®¤è¯**: å¿…éœ€
- **è¯·æ±‚å‚æ•°**: è·¯å¾„å‚æ•° `postId`

- **æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "åˆ é™¤æˆåŠŸ"
}
```

- **ä¸šåŠ¡é€»è¾‘**:
  - éªŒè¯æ‰€æœ‰æƒï¼ˆä»…ä½œè€…å¯åˆ é™¤ï¼‰
  - è½¯åˆ é™¤ï¼ˆä¿®æ”¹statuså­—æ®µï¼‰
  - å¯é€‰æ‹©æ˜¯å¦åŒæ—¶åˆ é™¤ç›¸å…³è¯„è®ºã€ç‚¹èµã€æ”¶è—è®°å½•

---

### 11. ç¼–è¾‘æˆ‘çš„åŠ¨æ€

**æ¥å£æè¿°**: ç¼–è¾‘ç”¨æˆ·è‡ªå·±å‘å¸ƒçš„åŠ¨æ€

- **URL**: `PUT /api/community/posts/{postId}`
- **è®¤è¯**: å¿…éœ€
- **è¯·æ±‚å‚æ•°**:
```json
{
  "content": "æ›´æ–°åçš„åŠ¨æ€å†…å®¹...",
  "images": [
    "https://cdn.example.com/new_img1.jpg"
  ],
  "tags": ["æ›´æ–°çš„æ ‡ç­¾"]
}
```

- **æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "æ›´æ–°æˆåŠŸ"
}
```

- **ä¸šåŠ¡é€»è¾‘**:
  - éªŒè¯æ‰€æœ‰æƒï¼ˆä»…ä½œè€…å¯ç¼–è¾‘ï¼‰
  - å†…å®¹å’Œå›¾ç‰‡éªŒè¯è§„åˆ™åŒå‘å¸ƒæ¥å£
  - æ›´æ–°æ—¶é—´æˆ³

---

### 12. åˆ é™¤æˆ‘çš„ç¤¾åŒºäº’åŠ¨è®°å½•

**æ¥å£æè¿°**: åˆ é™¤ä¸ªäººçš„ç‚¹èµã€æ”¶è—ã€è¯„è®ºè®°å½•

- **URL**: `DELETE /api/community/my/{type}/{recordId}`
- **è®¤è¯**: å¿…éœ€
- **è¯·æ±‚å‚æ•°**: 
  - `type`: ç±»å‹ (`likes`/`collects`/`comments`)
  - `recordId`: è®°å½•ID

- **æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "åˆ é™¤æˆåŠŸ"
}
```

---

## ğŸ”’ è®¤è¯ä¸æƒé™

### JWT Token æ ¼å¼
```json
{
  "userId": "user_123456",
  "username": "ç”¨æˆ·æ˜µç§°",
  "exp": 1640995200
}
```

### æƒé™éªŒè¯
- **å…¬å¼€æ¥å£**: åŠ¨æ€åˆ—è¡¨ã€åŠ¨æ€è¯¦æƒ…ã€è¯„è®ºåˆ—è¡¨ï¼ˆå¯é€‰ç™»å½•ï¼‰
- **éœ€è¦è®¤è¯**: å‘å¸ƒã€ç‚¹èµã€æ”¶è—ã€è¯„è®ºã€ä¸ªäººå†…å®¹ç®¡ç†
- **æ‰€æœ‰æƒéªŒè¯**: ç¼–è¾‘/åˆ é™¤åŠ¨æ€ã€åˆ é™¤è¯„è®º

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. æ•°æ®åº“ä¼˜åŒ–
```sql
-- çƒ­é—¨åŠ¨æ€æŸ¥è¯¢ç´¢å¼•
CREATE INDEX idx_hot_posts ON community_posts(status, created_at, likes_count, comments_count);

-- ç”¨æˆ·å‘å¸ƒåŠ¨æ€ç´¢å¼•
CREATE INDEX idx_user_posts ON community_posts(user_id, status, created_at);

-- ç‚¹èµçŠ¶æ€å¿«é€ŸæŸ¥è¯¢
CREATE INDEX idx_like_status ON community_likes(user_id, post_id);
```

### 2. Redisç¼“å­˜ç­–ç•¥
```
# çƒ­é—¨åŠ¨æ€åˆ—è¡¨ç¼“å­˜
community:hot_posts:page:{page} (TTL: 5åˆ†é’Ÿ)

# åŠ¨æ€è¯¦æƒ…ç¼“å­˜
community:post:{postId} (TTL: 30åˆ†é’Ÿ)

# ç”¨æˆ·ç‚¹èµçŠ¶æ€ç¼“å­˜
community:user_likes:{userId} (SETæ•°æ®ç»“æ„ï¼ŒTTL: 1å°æ—¶)

# åŠ¨æ€ç»Ÿè®¡æ•°æ®ç¼“å­˜
community:post_stats:{postId} (HASHï¼šlikes/comments/collects)
```

### 3. æ¥å£æ€§èƒ½è¦æ±‚
- **åŠ¨æ€åˆ—è¡¨**: <200ms
- **å‘å¸ƒåŠ¨æ€**: <500ms
- **ç‚¹èµ/æ”¶è—**: <100ms
- **è¯„è®ºå‘è¡¨**: <300ms

---

## ğŸ› ï¸ å¼€å‘å»ºè®®

### 1. é”™è¯¯å¤„ç†
```json
{
  "code": 400,
  "message": "åŠ¨æ€å†…å®¹ä¸èƒ½ä¸ºç©º",
  "data": null,
  "timestamp": "2024-01-15T10:30:00Z",
  "path": "/api/community/posts"
}
```

### 2. å¸¸è§é”™è¯¯ç 
- `200`: æˆåŠŸ
- `400`: å‚æ•°é”™è¯¯
- `401`: æœªè®¤è¯
- `403`: æƒé™ä¸è¶³
- `404`: èµ„æºä¸å­˜åœ¨
- `429`: è¯·æ±‚è¿‡äºé¢‘ç¹
- `500`: æœåŠ¡å™¨å†…é”™è¯¯

### 3. å†…å®¹å®¡æ ¸
- æ•æ„Ÿè¯è¿‡æ»¤
- å›¾ç‰‡å†…å®¹æ£€æµ‹
- ç”¨æˆ·ä¸¾æŠ¥æœºåˆ¶
- ç®¡ç†å‘˜å®¡æ ¸å·¥å…·

### 4. å›¾ç‰‡å¤„ç†
- æ”¯æŒå¤šç§æ ¼å¼ï¼šJPGã€PNGã€WebP
- å›¾ç‰‡å‹ç¼©å’Œä¸åŒå°ºå¯¸ç”Ÿæˆ
- CDNåŠ é€Ÿåˆ†å‘
- é˜²ç›—é“¾æœºåˆ¶

---

## ğŸ“ å‰ç«¯é›†æˆè¯´æ˜

### APIè°ƒç”¨ç¤ºä¾‹
```javascript
// å‰ç«¯å·²å°è£…çš„APIæ–¹æ³•
import api from '@/utils/api';

// è·å–åŠ¨æ€åˆ—è¡¨
const response = await api.community.getCommunityPosts('recommend', 1, 10);

// å‘å¸ƒåŠ¨æ€
const response = await api.community.publishPost({
  content: 'å†…å®¹',
  images: ['å›¾ç‰‡1', 'å›¾ç‰‡2'],
  tags: ['æ ‡ç­¾1', 'æ ‡ç­¾2']
});

// ç‚¹èµåŠ¨æ€
const response = await api.community.togglePostLike('postId');
```

### å‰ç«¯å®¹é”™æœºåˆ¶
- APIå¤±è´¥æ—¶è‡ªåŠ¨ä½¿ç”¨Mockæ•°æ®
- ç½‘ç»œå¼‚å¸¸æ—¶æ˜¾ç¤ºå‹å¥½æç¤º
- æ”¯æŒç¦»çº¿æµè§ˆå·²ç¼“å­˜å†…å®¹
- æä¾›é‡è¯•æœºåˆ¶

---

## ğŸ§ª æµ‹è¯•ç”¨ä¾‹å»ºè®®

### 1. åŠŸèƒ½æµ‹è¯•
- [ ] åŠ¨æ€å‘å¸ƒï¼ˆæ–‡å­—+å›¾ç‰‡ï¼‰
- [ ] åŠ¨æ€åˆ—è¡¨ï¼ˆæ¨è/æœ€æ–°ï¼‰
- [ ] ç‚¹èµ/å–æ¶ˆç‚¹èµ
- [ ] æ”¶è—/å–æ¶ˆæ”¶è—
- [ ] è¯„è®ºå‘è¡¨
- [ ] ä¸ªäººå†…å®¹ç®¡ç†

### 2. è¾¹ç•Œæµ‹è¯•
- [ ] ç©ºå†…å®¹å‘å¸ƒ
- [ ] è¶…é•¿å†…å®¹å‘å¸ƒ
- [ ] å›¾ç‰‡æ•°é‡é™åˆ¶
- [ ] é¢‘ç¹ç‚¹èµæµ‹è¯•
- [ ] å¤§é‡è¯„è®ºæ€§èƒ½

### 3. å®‰å…¨æµ‹è¯•
- [ ] XSSæ”»å‡»é˜²æŠ¤
- [ ] SQLæ³¨å…¥é˜²æŠ¤
- [ ] æœªè®¤è¯è®¿é—®é™åˆ¶
- [ ] æƒé™è¶Šç•Œæµ‹è¯•

---

## ğŸ“Š æ•°æ®ç»Ÿè®¡éœ€æ±‚

### 1. åŸºç¡€ç»Ÿè®¡
- æ—¥æ´»è·ƒç”¨æˆ·æ•°
- æ¯æ—¥å‘å¸ƒåŠ¨æ€æ•°
- æ¯æ—¥äº’åŠ¨æ•°ï¼ˆç‚¹èµ+è¯„è®º+æ”¶è—ï¼‰
- çƒ­é—¨è¯é¢˜ç»Ÿè®¡

### 2. ç”¨æˆ·åˆ†æ
- ç”¨æˆ·å‘å¸ƒé¢‘ç‡
- ç”¨æˆ·äº’åŠ¨åå¥½
- æ´»è·ƒæ—¶é—´åˆ†å¸ƒ
- æµå¤±ç”¨æˆ·åˆ†æ

---

## ğŸ¯ æ€»ç»“

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„å® ç‰©ç¤¾åŒºAPIè®¾è®¡æ–‡æ¡£ï¼Œå‰ç«¯å·²ç»å®Œå…¨å¼€å‘å®Œæˆå¹¶å…·å¤‡ä»¥ä¸‹ç‰¹è‰²ï¼š

### âœ… å·²å®ŒæˆåŠŸèƒ½
- **å‘å¸ƒåŠŸèƒ½**: æ”¯æŒå›¾æ–‡å‘å¸ƒã€è¯é¢˜æ ‡ç­¾ã€å­—æ•°ç»Ÿè®¡
- **æµè§ˆåŠŸèƒ½**: ç€‘å¸ƒæµå¸ƒå±€ã€åˆ†ç±»åˆ‡æ¢ã€ä¸‹æ‹‰åˆ·æ–°ã€ä¸Šæ‹‰åŠ è½½
- **äº’åŠ¨åŠŸèƒ½**: ç‚¹èµã€è¯„è®ºã€æ”¶è—ï¼Œå®æ—¶æ•°æ®æ›´æ–°
- **ä¸ªäººä¸­å¿ƒ**: æˆ‘çš„å‘å¸ƒã€æ”¶è—ã€ç‚¹èµã€è¯„è®ºç®¡ç†
- **ç”¨æˆ·ä½“éªŒ**: å›¾ç‰‡é¢„è§ˆã€é”™è¯¯å¤„ç†ã€Mockæ•°æ®å›é€€

### ğŸš€ æŠ€æœ¯ä¼˜åŠ¿
- **å¤šç«¯æ”¯æŒ**: H5+å°ç¨‹åº+APP
- **æ€§èƒ½ä¼˜åŒ–**: ç€‘å¸ƒæµ+åˆ†é¡µåŠ è½½
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„å®¹é”™æœºåˆ¶
- **APIè®¾è®¡**: RESTfulé£æ ¼ï¼Œæ˜“äºå®ç°

### ğŸ“‹ å¼€å‘æ¸…å•
æŒ‰ç…§æœ¬æ–‡æ¡£å®ç°12ä¸ªAPIæ¥å£ï¼Œå³å¯ä¸å‰ç«¯æ— ç¼å¯¹æ¥ï¼Œæ‰“é€ ä¸€ä¸ªä¸“ä¸šçš„å® ç‰©ç¤¾åŒºå¹³å°ã€‚

---

**è”ç³»æ–¹å¼**: å¦‚æœ‰APIå®ç°é—®é¢˜ï¼Œè¯·åŠæ—¶æ²Ÿé€šç¡®è®¤æ¥å£ç»†èŠ‚ã€‚

**æ›´æ–°æ—¥æœŸ**: 2024å¹´1æœˆ
